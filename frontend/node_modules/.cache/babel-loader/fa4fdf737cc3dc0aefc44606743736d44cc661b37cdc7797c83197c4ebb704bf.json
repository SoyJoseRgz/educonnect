{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect,useCallback,useMemo}from'react';import{authApi}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export const AuthProvider=_ref=>{let{children}=_ref;const[authState,setAuthState]=useState({isAuthenticated:false,isLoading:true,error:null});const checkAuthStatus=useCallback(async()=>{try{const isAuthenticated=await authApi.checkAuthStatus();setAuthState(prev=>({...prev,isAuthenticated,isLoading:false,error:null}));}catch(error){// Log unexpected errors (401s are handled silently in checkAuthStatus)\nconsole.warn('Unexpected error checking auth status:',error);setAuthState(prev=>({...prev,isAuthenticated:false,isLoading:false,error:null}));}},[]);// Check authentication status on mount\nuseEffect(()=>{checkAuthStatus();},[checkAuthStatus]);const login=useCallback(async(email,password)=>{setAuthState(prev=>({...prev,isLoading:true,error:null}));try{await authApi.login({email,password});setAuthState(prev=>({...prev,isAuthenticated:true,isLoading:false,error:null}));}catch(error){const apiError=error;setAuthState(prev=>({...prev,isAuthenticated:false,isLoading:false,error:apiError.status===401?'Credenciales incorrectas. Verifica tu correo y contrase침a.':apiError.message||'Error al iniciar sesi칩n. Intenta nuevamente.'}));throw error;// Re-throw to allow component-level handling\n}},[]);const logout=useCallback(async()=>{setAuthState(prev=>({...prev,isLoading:true,error:null}));try{await authApi.logout();}catch(error){// Even if logout fails on server, clear local state\nconsole.warn('Logout request failed:',error);}finally{setAuthState({isAuthenticated:false,isLoading:false,error:null});}},[]);const clearError=useCallback(()=>{setAuthState(prev=>({...prev,error:null}));},[]);const contextValue=useMemo(()=>({...authState,login,logout,clearError}),[authState,login,logout,clearError]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:contextValue,children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","useMemo","authApi","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","authState","setAuthState","isAuthenticated","isLoading","error","checkAuthStatus","prev","console","warn","login","email","password","apiError","status","message","logout","clearError","contextValue","Provider","value","useAuth","context","Error"],"sources":["/home/joserodriguez/educonnect/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback, useMemo } from 'react';\nimport { authApi, ApiError } from '../services/api';\n\ninterface AuthState {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  error: string | null;\n}\n\ninterface AuthContextType extends AuthState {\n  login: (email: string, password: string) => Promise<void>;\n  logout: () => Promise<void>;\n  clearError: () => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [authState, setAuthState] = useState<AuthState>({\n    isAuthenticated: false,\n    isLoading: true,\n    error: null,\n  });\n\n  const checkAuthStatus = useCallback(async () => {\n    try {\n      const isAuthenticated = await authApi.checkAuthStatus();\n      setAuthState(prev => ({\n        ...prev,\n        isAuthenticated,\n        isLoading: false,\n        error: null,\n      }));\n    } catch (error) {\n      // Log unexpected errors (401s are handled silently in checkAuthStatus)\n      console.warn('Unexpected error checking auth status:', error);\n\n      setAuthState(prev => ({\n        ...prev,\n        isAuthenticated: false,\n        isLoading: false,\n        error: null,\n      }));\n    }\n  }, []);\n\n  // Check authentication status on mount\n  useEffect(() => {\n    checkAuthStatus();\n  }, [checkAuthStatus]);\n\n  const login = useCallback(async (email: string, password: string): Promise<void> => {\n    setAuthState(prev => ({\n      ...prev,\n      isLoading: true,\n      error: null,\n    }));\n\n    try {\n      await authApi.login({ email, password });\n      setAuthState(prev => ({\n        ...prev,\n        isAuthenticated: true,\n        isLoading: false,\n        error: null,\n      }));\n    } catch (error) {\n      const apiError = error as ApiError;\n      setAuthState(prev => ({\n        ...prev,\n        isAuthenticated: false,\n        isLoading: false,\n        error: apiError.status === 401\n          ? 'Credenciales incorrectas. Verifica tu correo y contrase침a.'\n          : apiError.message || 'Error al iniciar sesi칩n. Intenta nuevamente.',\n      }));\n      throw error; // Re-throw to allow component-level handling\n    }\n  }, []);\n\n  const logout = useCallback(async (): Promise<void> => {\n    setAuthState(prev => ({\n      ...prev,\n      isLoading: true,\n      error: null,\n    }));\n\n    try {\n      await authApi.logout();\n    } catch (error) {\n      // Even if logout fails on server, clear local state\n      console.warn('Logout request failed:', error);\n    } finally {\n      setAuthState({\n        isAuthenticated: false,\n        isLoading: false,\n        error: null,\n      });\n    }\n  }, []);\n\n  const clearError = useCallback(() => {\n    setAuthState(prev => ({\n      ...prev,\n      error: null,\n    }));\n  }, []);\n\n  const contextValue: AuthContextType = useMemo(() => ({\n    ...authState,\n    login,\n    logout,\n    clearError,\n  }), [authState, login, logout, clearError]);\n\n  return (\n    <AuthContext.Provider value={contextValue}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}